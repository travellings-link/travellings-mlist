<!DOCTYPE html>

<html lang="zh">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>投诉网站 | 开往</title>
        <link href="https://unpkg.zhimg.com/bootstrap@4.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" defer></script>
        <script>
            function getQueryString(name) {
                const url_string = window.location.href;
                const url = new URL(url_string);
                return url.searchParams.get(name);
            }

            function submit(vk) {
                const id = document.getElementById("id").value;
                const reason = document.getElementById("reason").value;

                const data = {"id": id, "reason": reason, "vk": vk}
                fetch("https://api.travellings.cn/report", {
                    method: "POST", // or 'PUT'
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(data),
                })
                .then((response) => response.json())
                .then((data) => {
                    console.log("Success:", data);
                })
                .catch((error) => {
                    console.error("Error:", error);
                });
            }
        </script>
    </head>
    <body>
        <div class="container">
            <h1>投诉开往成员网站</h1>
            <p>你可以在这里对开往的成员网站进行投诉。请你详尽填写投诉理由，我们将尽快处理你的请求。</p>
        </div>
        <form>
            <div class="form-group">
            <label for="id">网站序号：</label>
            <input type="number" class="form-control" placeholder="输入网站序号" id="id">
            </div>
            <div class="form-group">
            <label for="reason">投诉理由：</label>
            <textarea class="form-control" placeholder="输入投诉理由" id="reason" rows="5"></textarea>
            </div>
            <div class="checkbox mb-3">
                <div id="check"></div>
            </div>
            <button onclick="submit(token)" class="btn btn-primary">提交投诉</button>
          </form>
        <script>
            if(getQueryString('id')) {
                document.getElementById("id").value = getQueryString('id');
            }

            window.onloadTurnstileCallback = function () {
                turnstile.render('#check', {
                    sitekey: '0x4AAAAAAARuWQIjaC-Tm8-m',
                    callback: function(token) {
                        var token = token;
                    },
                });
            };
        </script>
    </body>
</html>